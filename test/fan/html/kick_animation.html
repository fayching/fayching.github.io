<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<title>任务浮层</title>
<meta name="format-detection" content="telephone=no" />
<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no,minimal-ui" />
<link rel="stylesheet" href="../style/css/fan.css">

</head>
<body>
<div class="drop_wrap">
	<div class="prop_wrap">
		<div class="prop_flower_box"></div>
		<div class="prop_flower_box_front"></div>
	</div>
</div>
<script type="text/javascript" src="../js/jquery.min.js"></script>
<script>


window.onload = function(){
	$('.drop_wrap').addClass('active');
	// 开始飘花
	initFlower();
}

function initFlower() {
	for (var a = document.querySelector(".prop_flower_box"), b = document.querySelector(".prop_flower_box_front"), c = 0; NUMBER_OF_FLOWERS > c; c++) a.appendChild(createAFlower("normal"));
	for (var d = 0; NUMBER_OF_FLOWERS_FRONT > d; d++) b.appendChild(createAFlower("big"))
}

function randomInteger(a, b) {
	return a + Math.floor(Math.random() * (b - a))
}

function randomFloat(a, b) {
	return a + Math.random() * (b - a)
}

function pixelValue(a) {
	return a + "px"
}

function durationValue(a) {
	return a + "s"
}


function createAFlower(a) {
	var b = document.createElement("div");
	b.setAttribute("class", "prop_flower_wrap");
	var c = document.createElement("img");
	c.setAttribute("class", "prop_flower_item"), "normal" === a ? c.src = "http://i.gtimg.cn/qqlive/images/20160824/p" + randomInteger(1, 4) + ".png" : "big" === a && (c.src = "http://i.gtimg.cn/qqlive/images/20160824/p" + randomInteger(1, 4) + ".png"), b.style.top = "-100px";
	var d = window.innerWidth+100;
	b.style.left = pixelValue(randomInteger(0, d));
	var e = Math.random() < .5 ? "clockwiseSpin" : "counterclockwiseSpinAndFlip";
	$(b).css({
		AnimationName: "fade, droptoright"
	})
	$(c).css({
		AnimationName: e
	})
	var f;
	"normal" === a ? f = durationValue(randomFloat(4, 8)) : "big" === a && (f = durationValue(randomFloat(5, 11)));
	var g = durationValue(randomFloat(4, 8));
	b.style.webkitAnimationDuration = f + ", " + f;
	var h = durationValue(randomFloat(0, 5));
	return b.style.webkitAnimationDelay = h + ", " + h, c.style.webkitAnimationDuration = g, b.appendChild(c), b
}
const NUMBER_OF_FLOWERS = 30,
	NUMBER_OF_FLOWERS_FRONT = 15;

</script>

</body>
</html>
